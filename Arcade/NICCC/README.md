Ported from: https://github.com/dataflowg/niccc-labview