(()=>{var co=Object.create;var Pt=Object.defineProperty;var fo=Object.getOwnPropertyDescriptor;var _o=Object.getOwnPropertyNames;var po=Object.getPrototypeOf,ho=Object.prototype.hasOwnProperty;var Jr=h=>Pt(h,"__esModule",{value:!0});var Xr=(h,s)=>()=>(s||h((s={exports:{}}).exports,s),s.exports),mo=(h,s)=>{Jr(h);for(var n in s)Pt(h,n,{get:s[n],enumerable:!0})},go=(h,s,n)=>{if(s&&typeof s=="object"||typeof s=="function")for(let y of _o(s))!ho.call(h,y)&&y!=="default"&&Pt(h,y,{get:()=>s[y],enumerable:!(n=fo(s,y))||n.enumerable});return h},ir=h=>go(Jr(Pt(h!=null?co(po(h)):{},"default",h&&h.__esModule&&"default"in h?{get:()=>h.default,enumerable:!0}:{value:h,enumerable:!0})),h);var rn=Xr(($o,tn)=>{tn.exports.default={types:{float:{filter_operator:"==",aggregate:"sum",format:{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}},string:{filter_operator:"==",aggregate:"count"},integer:{filter_operator:"==",aggregate:"sum",format:{}},boolean:{filter_operator:"==",aggregate:"count"},datetime:{filter_operator:"==",aggregate:"count",format:{week:"numeric",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},null_value:-1},date:{filter_operator:"==",aggregate:"count",format:{week:"numeric",year:"numeric",month:"numeric",day:"numeric"},null_value:-1}}}});var kt=Xr((No,xe)=>{var nn=rn().default;xe.exports.get_types=function(){return Object.keys(xe.exports.get_config().types)};xe.exports.get_type_config=function(h){let s={};if(xe.exports.get_config().types[h]&&Object.assign(s,xe.exports.get_config().types[h]),s.type){let n=xe.exports.get_type_config(s.type);return Object.assign(n,s),n}else return s};function ar(h){return h&&typeof h=="object"&&!Array.isArray(h)}function Rt(h,...s){if(!s.length)return h;let n=s.shift();if(ar(h)&&ar(n))for(let y in n)ar(n[y])?(h[y]||Object.assign(h,{[y]:{}}),Rt(h[y],n[y])):Object.assign(h,{[y]:n[y]});return Rt(h,...s)}self.__PERSPECTIVE_CONFIG__=void 0;xe.exports.override_config=function(h){self.__PERSPECTIVE_CONFIG__&&console.warn("Config already initialized!"),self.__PERSPECTIVE_CONFIG__=Rt(nn,h)};xe.exports.get_config=function(){return self.__PERSPECTIVE_CONFIG__||(self.__PERSPECTIVE_CONFIG__=Rt(nn,self.__TEMPLATE_CONFIG__||{})),self.__PERSPECTIVE_CONFIG__}});var vo=function(){var h=typeof document!="undefined"&&document.currentScript?document.currentScript.src:void 0;return function(s){s=s||{};var n=typeof s!="undefined"?s:{},y,N;n.ready=new Promise(function(e,t){y=e,N=t});var k={},x;for(x in n)n.hasOwnProperty(x)&&(k[x]=n[x]);var L=[],B="./this.program",de=function(e,t){throw t},I=!1,We=!0,re="";function Ke(e){return n.locateFile?n.locateFile(e,re):re+e}var pt,Nt,Ne,Oe;(I||We)&&(We?re=self.location.href:typeof document!="undefined"&&document.currentScript&&(re=document.currentScript.src),h&&(re=h),re.indexOf("blob:")!==0?re=re.substr(0,re.lastIndexOf("/")+1):re="",pt=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},We&&(Ne=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),Nt=function(e,t,r){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){if(i.status==200||i.status==0&&i.response){t(i.response);return}r()},i.onerror=r,i.send(null)},Oe=function(e){document.title=e});var H=n.print||console.log.bind(console),ve=n.printErr||console.warn.bind(console);for(x in k)k.hasOwnProperty(x)&&(n[x]=k[x]);k=null,n.arguments&&(L=n.arguments),n.thisProgram&&(B=n.thisProgram),n.quit&&(de=n.quit);var Le=0,It=function(e){Le=e},ie;n.wasmBinary&&(ie=n.wasmBinary);var Mt=n.noExitRuntime||!0;typeof WebAssembly!="object"&&ze("no native wasm support detected");var o,a=!1,d;function m(e,t){e||ze("Assertion failed: "+t)}var w=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):void 0;function A(e,t,r){t>>>=0;for(var i=t+r,l=t;e[l>>>0]&&!(l>=i);)++l;if(l-t>16&&e.subarray&&w)return w.decode(e.subarray(t>>>0,l>>>0));for(var c="";t<l;){var f=e[t++>>>0];if(!(f&128)){c+=String.fromCharCode(f);continue}var u=e[t++>>>0]&63;if((f&224)==192){c+=String.fromCharCode((f&31)<<6|u);continue}var _=e[t++>>>0]&63;if((f&240)==224?f=(f&15)<<12|u<<6|_:f=(f&7)<<18|u<<12|_<<6|e[t++>>>0]&63,f<65536)c+=String.fromCharCode(f);else{var v=f-65536;c+=String.fromCharCode(55296|v>>10,56320|v&1023)}}return c}function S(e,t){return e>>>=0,e?A(U,e,t):""}function C(e,t,r,i){if(r>>>=0,!(i>0))return 0;for(var l=r,c=r+i-1,f=0;f<e.length;++f){var u=e.charCodeAt(f);if(u>=55296&&u<=57343){var _=e.charCodeAt(++f);u=65536+((u&1023)<<10)|_&1023}if(u<=127){if(r>=c)break;t[r++>>>0]=u}else if(u<=2047){if(r+1>=c)break;t[r++>>>0]=192|u>>6,t[r++>>>0]=128|u&63}else if(u<=65535){if(r+2>=c)break;t[r++>>>0]=224|u>>12,t[r++>>>0]=128|u>>6&63,t[r++>>>0]=128|u&63}else{if(r+3>=c)break;t[r++>>>0]=240|u>>18,t[r++>>>0]=128|u>>12&63,t[r++>>>0]=128|u>>6&63,t[r++>>>0]=128|u&63}}return t[r>>>0]=0,r-l}function M(e,t,r){return C(e,U,t,r)}function P(e){for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&(i=65536+((i&1023)<<10)|e.charCodeAt(++r)&1023),i<=127?++t:i<=2047?t+=2:i<=65535?t+=3:t+=4}return t}var W=typeof TextDecoder!="undefined"?new TextDecoder("utf-16le"):void 0;function q(e,t){for(var r=e,i=r>>1,l=i+t/2;!(i>=l)&&me[i>>>0];)++i;if(r=i<<1,r-e>32&&W)return W.decode(U.subarray(e>>>0,r>>>0));for(var c="",f=0;!(f>=t/2);++f){var u=K[e+f*2>>>1];if(u==0)break;c+=String.fromCharCode(u)}return c}function J(e,t,r){if(r===void 0&&(r=2147483647),r<2)return 0;r-=2;for(var i=t,l=r<e.length*2?r/2:e.length,c=0;c<l;++c){var f=e.charCodeAt(c);K[t>>>1]=f,t+=2}return K[t>>>1]=0,t-i}function pe(e){return e.length*2}function he(e,t){for(var r=0,i="";!(r>=t/4);){var l=g[e+r*4>>>2];if(l==0)break;if(++r,l>=65536){var c=l-65536;i+=String.fromCharCode(55296|c>>10,56320|c&1023)}else i+=String.fromCharCode(l)}return i}function ye(e,t,r){if(t>>>=0,r===void 0&&(r=2147483647),r<4)return 0;for(var i=t,l=i+r-4,c=0;c<e.length;++c){var f=e.charCodeAt(c);if(f>=55296&&f<=57343){var u=e.charCodeAt(++c);f=65536+((f&1023)<<10)|u&1023}if(g[t>>>2]=f,t+=4,t+4>l)break}return g[t>>>2]=0,t-i}function He(e){for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&++r,t+=4}return t}function ht(e){var t=P(e)+1,r=ct(t);return r&&C(e,V,r,t),r}function mt(e){var t=P(e)+1,r=tr(t);return C(e,V,r,t),r}function ue(e,t){V.set(e,t>>>0)}function we(e,t,r){for(var i=0;i<e.length;++i)V[t++>>>0]=e.charCodeAt(i);r||(V[t>>>0]=0)}function Re(e,t){return e%t>0&&(e+=t-e%t),e}var se,V,U,K,me,g,oe,Ze,Vt;function hr(e){se=e,n.HEAP8=V=new Int8Array(e),n.HEAP16=K=new Int16Array(e),n.HEAP32=g=new Int32Array(e),n.HEAPU8=U=new Uint8Array(e),n.HEAPU16=me=new Uint16Array(e),n.HEAPU32=oe=new Uint32Array(e),n.HEAPF32=Ze=new Float32Array(e),n.HEAPF64=Vt=new Float64Array(e)}var ko=n.INITIAL_MEMORY||16777216,Qe,mr=[],gr=[],an=[],vr=[],ln=!1,un=!1,cn=0;function yr(){return Mt||cn>0}function fn(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)mn(n.preRun.shift());gt(mr)}function _n(){ln=!0,gt(gr)}function dn(){gt(an)}function pn(){un=!0}function hn(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)vn(n.postRun.shift());gt(vr)}function mn(e){mr.unshift(e)}function gn(e){gr.unshift(e)}function vn(e){vr.unshift(e)}var Ie=0,Ut=null,et=null;function yn(e){Ie++,n.monitorRunDependencies&&n.monitorRunDependencies(Ie)}function wn(e){if(Ie--,n.monitorRunDependencies&&n.monitorRunDependencies(Ie),Ie==0&&(Ut!==null&&(clearInterval(Ut),Ut=null),et)){var t=et;et=null,t()}}n.preloadedImages={},n.preloadedAudios={};function ze(e){n.onAbort&&n.onAbort(e),e+="",ve(e),a=!0,d=1,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(e);throw N(t),t}var bn="data:application/octet-stream;base64,";function wr(e){return e.startsWith(bn)}var ge;ge="perspective.cpp.wasm",wr(ge)||(ge=Ke(ge));function br(e){try{if(e==ge&&ie)return new Uint8Array(ie);if(Ne)return Ne(e);throw"both async and sync fetching of the wasm failed"}catch(t){ze(t)}}function Tn(){return!ie&&(I||We)&&typeof fetch=="function"?fetch(ge,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ge+"'";return e.arrayBuffer()}).catch(function(){return br(ge)}):Promise.resolve().then(function(){return br(ge)})}function Cn(){var e={a:Us};function t(f,u){var _=f.exports;n.asm=_,o=n.asm.qa,hr(o.buffer),Qe=n.asm.va,gn(n.asm.ra),wn("wasm-instantiate")}yn("wasm-instantiate");function r(f){t(f.instance)}function i(f){return Tn().then(function(u){return WebAssembly.instantiate(u,e)}).then(function(u){return u}).then(f,function(u){ve("failed to asynchronously prepare wasm: "+u),ze(u)})}function l(){return!ie&&typeof WebAssembly.instantiateStreaming=="function"&&!wr(ge)&&typeof fetch=="function"?fetch(ge,{credentials:"same-origin"}).then(function(f){var u=WebAssembly.instantiateStreaming(f,e);return u.then(r,function(_){return ve("wasm streaming compile failed: "+_),ve("falling back to ArrayBuffer instantiation"),i(r)})}):i(r)}if(n.instantiateWasm)try{var c=n.instantiateWasm(e,t);return c}catch(f){return ve("Module.instantiateWasm callback failed with error: "+f),!1}return l().catch(N),{}}var En={798396:function(){if(typeof self!="undefined")try{if(self.dispatchEvent&&!self._perspective_initialized&&self.document!==null){self._perspective_initialized=!0;var e=self.document.createEvent("Event");e.initEvent("perspective-ready",!1,!0),self.dispatchEvent(e)}else!self.document&&self.postMessage&&self.postMessage({})}catch{}},798781:function(e){throw new Error(S(e))}};function gt(e){for(;e.length>0;){var t=e.shift();if(typeof t=="function"){t(n);continue}var r=t.func;typeof r=="number"?t.arg===void 0?Qe.get(r)():Qe.get(r)(t.arg):r(t.arg===void 0?null:t.arg)}}function An(e){if(e instanceof zr||e=="unwind")return d;var t=e;ve("exception thrown: "+t),de(1,e)}function On(e,t,r,i){ze("Assertion failed: "+S(e)+", at: "+[t?S(t):"unknown filename",r,i?S(i):"unknown function"])}function Sn(e){return ct(e+16)+16}function Pn(e){this.excPtr=e,this.ptr=e-16,this.set_type=function(t){g[this.ptr+4>>>2]=t},this.get_type=function(){return g[this.ptr+4>>>2]},this.set_destructor=function(t){g[this.ptr+8>>>2]=t},this.get_destructor=function(){return g[this.ptr+8>>>2]},this.set_refcount=function(t){g[this.ptr>>>2]=t},this.set_caught=function(t){t=t?1:0,V[this.ptr+12>>>0]=t},this.get_caught=function(){return V[this.ptr+12>>>0]!=0},this.set_rethrown=function(t){t=t?1:0,V[this.ptr+13>>>0]=t},this.get_rethrown=function(){return V[this.ptr+13>>>0]!=0},this.init=function(t,r){this.set_type(t),this.set_destructor(r),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var t=g[this.ptr>>>2];g[this.ptr>>>2]=t+1},this.release_ref=function(){var t=g[this.ptr>>>2];return g[this.ptr>>>2]=t-1,t===1}}var xn=0,Rn=0;function kn(e,t,r){var i=new Pn(e);throw i.init(t,r),xn=e,Rn++,e}function jn(){var e=new Date().getFullYear(),t=new Date(e,0,1),r=new Date(e,6,1),i=t.getTimezoneOffset(),l=r.getTimezoneOffset(),c=Math.max(i,l);g[Lr()>>>2]=c*60,g[Wr()>>>2]=Number(i!=l);function f(O){var E=O.toTimeString().match(/\(([A-Za-z ]+)\)$/);return E?E[1]:"GMT"}var u=f(t),_=f(r),v=ht(u),T=ht(_);l<i?(g[Je()>>>2]=v,g[Je()+4>>>2]=T):(g[Je()>>>2]=T,g[Je()+4>>>2]=v)}function Wt(){Wt.called||(Wt.called=!0,jn())}function Fn(e,t){Wt();var r=new Date(g[e>>>2]*1e3);g[t>>>2]=r.getSeconds(),g[t+4>>>2]=r.getMinutes(),g[t+8>>>2]=r.getHours(),g[t+12>>>2]=r.getDate(),g[t+16>>>2]=r.getMonth(),g[t+20>>>2]=r.getFullYear()-1900,g[t+24>>>2]=r.getDay();var i=new Date(r.getFullYear(),0,1),l=(r.getTime()-i.getTime())/(1e3*60*60*24)|0;g[t+28>>>2]=l,g[t+36>>>2]=-(r.getTimezoneOffset()*60);var c=new Date(r.getFullYear(),6,1).getTimezoneOffset(),f=i.getTimezoneOffset(),u=(c!=f&&r.getTimezoneOffset()==Math.min(f,c))|0;g[t+32>>>2]=u;var _=g[Je()+(u?4:0)>>>2];return g[t+40>>>2]=_,t}function Dn(e,t){return Fn(e,t)}function $n(e){return g[Vr()>>>2]=e,e}var ce={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var r=ce.buffers[e];t===0||t===10?((e===1?H:ve)(A(r,0)),r.length=0):r.push(t)},varargs:void 0,get:function(){ce.varargs+=4;var e=g[ce.varargs-4>>>2];return e},getStr:function(e){var t=S(e);return t},get64:function(e,t){return e}};function Nn(e,t,r){return ce.varargs=r,0}function In(e,t,r,i){}function Mn(e,t,r){}function Vn(){return 42}function Un(e,t,r){return ce.varargs=r,0}function Wn(e,t,r){return 0}function Ln(e,t){U.fill(0,e,e+t)}function Hn(e,t){return Math.ceil(e/t)*t}function zn(e){e=Hn(e,65536);var t=Hr(65536,e);return t?(Ln(t,e),t):0}function Yn(e,t,r,i,l,c){c<<=12;var f,u=!1;if((i&16)!=0&&e%65536!=0)return-28;if((i&32)!=0){if(f=zn(t),!f)return-48;u=!0}else return-52;return f>>>=0,ce.mappings[f]={malloc:f,len:t,allocated:u,fd:l,prot:r,flags:i,offset:c},f}function Gn(e,t,r,i,l,c){return Yn(e,t,r,i,l,c)}function Bn(e,t,r,i){return-48}function qn(e,t){e>>>=0;var r=ce.mappings[e];return t===0||!r?-28:(t===r.len&&(ce.mappings[e]=null,r.allocated&&Ce(r.malloc)),0)}function Jn(e,t){return qn(e,t)}function Xn(e,t,r){ce.varargs=r}function Kn(e,t){}function Zn(e){}var vt={};function Lt(e){for(;e.length;){var t=e.pop(),r=e.pop();r(t)}}function tt(e){return this.fromWireType(oe[e>>>2])}var Ye={},Me={},yt={},Qn=48,ei=57;function wt(e){if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return t>=Qn&&t<=ei?"_"+e:e}function bt(e,t){return e=wt(e),new Function("body","return function "+e+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(t)}function Ht(e,t){var r=bt(t,function(i){this.name=t,this.message=i;var l=new Error(i).stack;l!==void 0&&(this.stack=this.toString()+`
`+l.replace(/^Error(:[^\n]*)?\n/,""))});return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},r}var Tr=void 0;function Tt(e){throw new Tr(e)}function ke(e,t,r){e.forEach(function(u){yt[u]=t});function i(u){var _=r(u);_.length!==e.length&&Tt("Mismatched type converter count");for(var v=0;v<e.length;++v)be(e[v],_[v])}var l=new Array(t.length),c=[],f=0;t.forEach(function(u,_){Me.hasOwnProperty(u)?l[_]=Me[u]:(c.push(u),Ye.hasOwnProperty(u)||(Ye[u]=[]),Ye[u].push(function(){l[_]=Me[u],++f,f===c.length&&i(l)}))}),c.length===0&&i(l)}function ti(e){var t=vt[e];delete vt[e];var r=t.rawConstructor,i=t.rawDestructor,l=t.fields,c=l.map(function(f){return f.getterReturnType}).concat(l.map(function(f){return f.setterArgumentType}));ke([e],c,function(f){var u={};return l.forEach(function(_,v){var T=_.fieldName,O=f[v],E=_.getter,j=_.getterContext,z=f[v+l.length],G=_.setter,Z=_.setterContext;u[T]={read:function(R){return O.fromWireType(E(j,R))},write:function(R,p){var b=[];G(Z,R,z.toWireType(b,p)),Lt(b)}}}),[{name:t.name,fromWireType:function(_){var v={};for(var T in u)v[T]=u[T].read(_);return i(_),v},toWireType:function(_,v){for(var T in u)if(!(T in v))throw new TypeError('Missing field:  "'+T+'"');var O=r();for(T in u)u[T].write(O,v[T]);return _!==null&&_.push(i,O),O},argPackAdvance:8,readValueFromPointer:tt,destructorFunction:i}]})}function ri(e,t,r,i,l){}function Ct(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function ni(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);Cr=e}var Cr=void 0;function X(e){for(var t="",r=e;U[r>>>0];)t+=Cr[U[r++>>>0]];return t}var Ge=void 0;function $(e){throw new Ge(e)}function be(e,t,r){if(r=r||{},!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var i=t.name;if(e||$('type "'+i+'" must have a positive integer typeid pointer'),Me.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;$("Cannot register type '"+i+"' twice")}if(Me[e]=t,delete yt[e],Ye.hasOwnProperty(e)){var l=Ye[e];delete Ye[e],l.forEach(function(c){c()})}}function ii(e,t,r,i,l){var c=Ct(r);t=X(t),be(e,{name:t,fromWireType:function(f){return!!f},toWireType:function(f,u){return u?i:l},argPackAdvance:8,readValueFromPointer:function(f){var u;if(r===1)u=V;else if(r===2)u=K;else if(r===4)u=g;else throw new TypeError("Unknown boolean type size: "+t);return this.fromWireType(u[f>>>c])},destructorFunction:null})}function si(e){if(!(this instanceof je)||!(e instanceof je))return!1;for(var t=this.$$.ptrType.registeredClass,r=this.$$.ptr,i=e.$$.ptrType.registeredClass,l=e.$$.ptr;t.baseClass;)r=t.upcast(r),t=t.baseClass;for(;i.baseClass;)l=i.upcast(l),i=i.baseClass;return t===i&&r===l}function oi(e){return{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}}function zt(e){function t(r){return r.$$.ptrType.registeredClass.name}$(t(e)+" instance already deleted")}var Yt=!1;function Er(e){}function ai(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}function Ar(e){e.count.value-=1;var t=e.count.value===0;t&&ai(e)}function rt(e){return typeof FinalizationGroup=="undefined"?(rt=function(t){return t},e):(Yt=new FinalizationGroup(function(t){for(var r=t.next();!r.done;r=t.next()){var i=r.value;i.ptr?Ar(i):console.warn("object already deleted: "+i.ptr)}}),rt=function(t){return Yt.register(t,t.$$,t.$$),t},Er=function(t){Yt.unregister(t.$$)},rt(e))}function li(){if(this.$$.ptr||zt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=rt(Object.create(Object.getPrototypeOf(this),{$$:{value:oi(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e}function ui(){this.$$.ptr||zt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&$("Object already scheduled for deletion"),Er(this),Ar(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function ci(){return!this.$$.ptr}var nt=void 0,it=[];function Gt(){for(;it.length;){var e=it.pop();e.$$.deleteScheduled=!1,e.delete()}}function fi(){return this.$$.ptr||zt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&$("Object already scheduled for deletion"),it.push(this),it.length===1&&nt&&nt(Gt),this.$$.deleteScheduled=!0,this}function _i(){je.prototype.isAliasOf=si,je.prototype.clone=li,je.prototype.delete=ui,je.prototype.isDeleted=ci,je.prototype.deleteLater=fi}function je(){}var Or={};function Sr(e,t,r){if(e[t].overloadTable===void 0){var i=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||$("Function '"+r+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[i.argCount]=i}}function Bt(e,t,r){n.hasOwnProperty(e)?((r===void 0||n[e].overloadTable!==void 0&&n[e].overloadTable[r]!==void 0)&&$("Cannot register public name '"+e+"' twice"),Sr(n,e,e),n.hasOwnProperty(r)&&$("Cannot register multiple overloads of a function with the same number of arguments ("+r+")!"),n[e].overloadTable[r]=t):(n[e]=t,r!==void 0&&(n[e].numArguments=r))}function di(e,t,r,i,l,c,f,u){this.name=e,this.constructor=t,this.instancePrototype=r,this.rawDestructor=i,this.baseClass=l,this.getActualType=c,this.upcast=f,this.downcast=u,this.pureVirtualFunctions=[]}function qt(e,t,r){for(;t!==r;)t.upcast||$("Expected null or instance of "+r.name+", got an instance of "+t.name),e=t.upcast(e),t=t.baseClass;return e}function pi(e,t){if(t===null)return this.isReference&&$("null is not a valid "+this.name),0;t.$$||$('Cannot pass "'+Be(t)+'" as a '+this.name),t.$$.ptr||$("Cannot pass deleted object as a pointer of type "+this.name);var r=t.$$.ptrType.registeredClass,i=qt(t.$$.ptr,r,this.registeredClass);return i}function hi(e,t){var r;if(t===null)return this.isReference&&$("null is not a valid "+this.name),this.isSmartPointer?(r=this.rawConstructor(),e!==null&&e.push(this.rawDestructor,r),r):0;t.$$||$('Cannot pass "'+Be(t)+'" as a '+this.name),t.$$.ptr||$("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&t.$$.ptrType.isConst&&$("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);var i=t.$$.ptrType.registeredClass;if(r=qt(t.$$.ptr,i,this.registeredClass),this.isSmartPointer)switch(t.$$.smartPtr===void 0&&$("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?r=t.$$.smartPtr:$("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:r=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)r=t.$$.smartPtr;else{var l=t.clone();r=this.rawShare(r,te(function(){l.delete()})),e!==null&&e.push(this.rawDestructor,r)}break;default:$("Unsupporting sharing policy")}return r}function mi(e,t){if(t===null)return this.isReference&&$("null is not a valid "+this.name),0;t.$$||$('Cannot pass "'+Be(t)+'" as a '+this.name),t.$$.ptr||$("Cannot pass deleted object as a pointer of type "+this.name),t.$$.ptrType.isConst&&$("Cannot convert argument of type "+t.$$.ptrType.name+" to parameter type "+this.name);var r=t.$$.ptrType.registeredClass,i=qt(t.$$.ptr,r,this.registeredClass);return i}function gi(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e}function vi(e){this.rawDestructor&&this.rawDestructor(e)}function yi(e){e!==null&&e.delete()}function Pr(e,t,r){if(t===r)return e;if(r.baseClass===void 0)return null;var i=Pr(e,t,r.baseClass);return i===null?null:r.downcast(i)}function wi(){return Object.keys(st).length}function bi(){var e=[];for(var t in st)st.hasOwnProperty(t)&&e.push(st[t]);return e}function Ti(e){nt=e,it.length&&nt&&nt(Gt)}function Ci(){n.getInheritedInstanceCount=wi,n.getLiveInheritedInstances=bi,n.flushPendingDeletes=Gt,n.setDelayFunction=Ti}var st={};function Ei(e,t){for(t===void 0&&$("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t}function Ai(e,t){return t=Ei(e,t),st[t]}function Et(e,t){(!t.ptrType||!t.ptr)&&Tt("makeClassHandle requires ptr and ptrType");var r=!!t.smartPtrType,i=!!t.smartPtr;return r!==i&&Tt("Both smartPtrType and smartPtr must be specified"),t.count={value:1},rt(Object.create(e,{$$:{value:t}}))}function Oi(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var r=Ai(this.registeredClass,t);if(r!==void 0){if(r.$$.count.value===0)return r.$$.ptr=t,r.$$.smartPtr=e,r.clone();var i=r.clone();return this.destructor(e),i}function l(){return this.isSmartPointer?Et(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):Et(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var c=this.registeredClass.getActualType(t),f=Or[c];if(!f)return l.call(this);var u;this.isConst?u=f.constPointerType:u=f.pointerType;var _=Pr(t,this.registeredClass,u.registeredClass);return _===null?l.call(this):this.isSmartPointer?Et(u.registeredClass.instancePrototype,{ptrType:u,ptr:_,smartPtrType:this,smartPtr:e}):Et(u.registeredClass.instancePrototype,{ptrType:u,ptr:_})}function Si(){Te.prototype.getPointee=gi,Te.prototype.destructor=vi,Te.prototype.argPackAdvance=8,Te.prototype.readValueFromPointer=tt,Te.prototype.deleteObject=yi,Te.prototype.fromWireType=Oi}function Te(e,t,r,i,l,c,f,u,_,v,T){this.name=e,this.registeredClass=t,this.isReference=r,this.isConst=i,this.isSmartPointer=l,this.pointeeType=c,this.sharingPolicy=f,this.rawGetPointee=u,this.rawConstructor=_,this.rawShare=v,this.rawDestructor=T,!l&&t.baseClass===void 0?i?(this.toWireType=pi,this.destructorFunction=null):(this.toWireType=mi,this.destructorFunction=null):this.toWireType=hi}function xr(e,t,r){n.hasOwnProperty(e)||Tt("Replacing nonexistant public symbol"),n[e].overloadTable!==void 0&&r!==void 0?n[e].overloadTable[r]=t:(n[e]=t,n[e].argCount=r)}function Pi(e,t,r){var i=n["dynCall_"+e];return r&&r.length?i.apply(null,[t].concat(r)):i.call(null,t)}function xi(e,t,r){return e.includes("j")?Pi(e,t,r):Qe.get(t).apply(null,r)}function Ri(e,t){var r=[];return function(){r.length=arguments.length;for(var i=0;i<arguments.length;i++)r[i]=arguments[i];return xi(e,t,r)}}function ee(e,t){e=X(e);function r(){return e.includes("j")?Ri(e,t):Qe.get(t)}var i=r();return typeof i!="function"&&$("unknown function pointer with signature "+e+": "+t),i}var Rr=void 0;function kr(e){var t=Ur(e),r=X(t);return Ce(t),r}function At(e,t){var r=[],i={};function l(c){if(!i[c]&&!Me[c]){if(yt[c]){yt[c].forEach(l);return}r.push(c),i[c]=!0}}throw t.forEach(l),new Rr(e+": "+r.map(kr).join([", "]))}function ki(e,t,r,i,l,c,f,u,_,v,T,O,E){T=X(T),c=ee(l,c),u&&(u=ee(f,u)),v&&(v=ee(_,v)),E=ee(O,E);var j=wt(T);Bt(j,function(){At("Cannot construct "+T+" due to unbound types",[i])}),ke([e,t,r],i?[i]:[],function(z){z=z[0];var G,Z;i?(G=z.registeredClass,Z=G.instancePrototype):Z=je.prototype;var R=bt(j,function(){if(Object.getPrototypeOf(this)!==p)throw new Ge("Use 'new' to construct "+T);if(b.constructor_body===void 0)throw new Ge(T+" has no accessible constructor");var ne=b.constructor_body[arguments.length];if(ne===void 0)throw new Ge("Tried to invoke ctor of "+T+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(b.constructor_body).toString()+") parameters instead!");return ne.apply(this,arguments)}),p=Object.create(Z,{constructor:{value:R}});R.prototype=p;var b=new di(T,R,p,E,G,c,u,v),Y=new Te(T,b,!0,!1,!1),F=new Te(T+"*",b,!1,!1,!1),Q=new Te(T+" const*",b,!1,!0,!1);return Or[e]={pointerType:F,constPointerType:Q},xr(j,R),[Y,F,Q]})}function Jt(e,t){for(var r=[],i=0;i<e;i++)r.push(g[(t>>2)+i>>>0]);return r}function ji(e,t,r,i,l,c){m(t>0);var f=Jt(t,r);l=ee(i,l),ke([],[e],function(u){u=u[0];var _="constructor "+u.name;if(u.registeredClass.constructor_body===void 0&&(u.registeredClass.constructor_body=[]),u.registeredClass.constructor_body[t-1]!==void 0)throw new Ge("Cannot register multiple constructors with identical number of parameters ("+(t-1)+") for class '"+u.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return u.registeredClass.constructor_body[t-1]=function(){At("Cannot construct "+u.name+" due to unbound types",f)},ke([],f,function(v){return v.splice(1,0,null),u.registeredClass.constructor_body[t-1]=Xt(_,v,null,l,c),[]}),[]})}function jr(e,t){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var r=bt(e.name||"unknownFunctionName",function(){});r.prototype=e.prototype;var i=new r,l=e.apply(i,t);return l instanceof Object?l:i}function Xt(e,t,r,i,l){var c=t.length;c<2&&$("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var f=t[1]!==null&&r!==null,u=!1,_=1;_<t.length;++_)if(t[_]!==null&&t[_].destructorFunction===void 0){u=!0;break}for(var v=t[0].name!=="void",T="",O="",_=0;_<c-2;++_)T+=(_!==0?", ":"")+"arg"+_,O+=(_!==0?", ":"")+"arg"+_+"Wired";var E="return function "+wt(e)+"("+T+`) {
if (arguments.length !== `+(c-2)+`) {
throwBindingError('function `+e+" called with ' + arguments.length + ' arguments, expected "+(c-2)+` args!');
}
`;u&&(E+=`var destructors = [];
`);var j=u?"destructors":"null",z=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],G=[$,i,l,Lt,t[0],t[1]];f&&(E+="var thisWired = classParam.toWireType("+j+`, this);
`);for(var _=0;_<c-2;++_)E+="var arg"+_+"Wired = argType"+_+".toWireType("+j+", arg"+_+"); // "+t[_+2].name+`
`,z.push("argType"+_),G.push(t[_+2]);if(f&&(O="thisWired"+(O.length>0?", ":"")+O),E+=(v?"var rv = ":"")+"invoker(fn"+(O.length>0?", ":"")+O+`);
`,u)E+=`runDestructors(destructors);
`;else for(var _=f?1:2;_<t.length;++_){var Z=_===1?"thisWired":"arg"+(_-2)+"Wired";t[_].destructorFunction!==null&&(E+=Z+"_dtor("+Z+"); // "+t[_].name+`
`,z.push(Z+"_dtor"),G.push(t[_].destructorFunction))}v&&(E+=`var ret = retType.fromWireType(rv);
return ret;
`),E+=`}
`,z.push(E);var R=jr(Function,z).apply(null,G);return R}function Fi(e,t,r,i,l,c,f,u){var _=Jt(r,i);t=X(t),c=ee(l,c),ke([],[e],function(v){v=v[0];var T=v.name+"."+t;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),u&&v.registeredClass.pureVirtualFunctions.push(t);function O(){At("Cannot call "+T+" due to unbound types",_)}var E=v.registeredClass.instancePrototype,j=E[t];return j===void 0||j.overloadTable===void 0&&j.className!==v.name&&j.argCount===r-2?(O.argCount=r-2,O.className=v.name,E[t]=O):(Sr(E,t,T),E[t].overloadTable[r-2]=O),ke([],_,function(z){var G=Xt(T,z,v,c,f);return E[t].overloadTable===void 0?(G.argCount=r-2,E[t]=G):E[t].overloadTable[r-2]=G,[]}),[]})}var Kt=[],ae=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Zt(e){e>4&&--ae[e].refcount==0&&(ae[e]=void 0,Kt.push(e))}function Di(){for(var e=0,t=5;t<ae.length;++t)ae[t]!==void 0&&++e;return e}function $i(){for(var e=5;e<ae.length;++e)if(ae[e]!==void 0)return ae[e];return null}function Ni(){n.count_emval_handles=Di,n.get_first_emval=$i}function te(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var t=Kt.length?Kt.pop():ae.length;return ae[t]={refcount:1,value:e},t}}}function Ii(e,t){t=X(t),be(e,{name:t,fromWireType:function(r){var i=ae[r].value;return Zt(r),i},toWireType:function(r,i){return te(i)},argPackAdvance:8,readValueFromPointer:tt,destructorFunction:null})}function Mi(e,t,r){switch(t){case 0:return function(i){var l=r?V:U;return this.fromWireType(l[i>>>0])};case 1:return function(i){var l=r?K:me;return this.fromWireType(l[i>>>1])};case 2:return function(i){var l=r?g:oe;return this.fromWireType(l[i>>>2])};default:throw new TypeError("Unknown integer type: "+e)}}function Vi(e,t,r,i){var l=Ct(r);t=X(t);function c(){}c.values={},be(e,{name:t,constructor:c,fromWireType:function(f){return this.constructor.values[f]},toWireType:function(f,u){return u.value},argPackAdvance:8,readValueFromPointer:Mi(t,l,i),destructorFunction:null}),Bt(t,c)}function ot(e,t){var r=Me[e];return r===void 0&&$(t+" has unknown type "+kr(e)),r}function Ui(e,t,r){var i=ot(e,"enum");t=X(t);var l=i.constructor,c=Object.create(i.constructor.prototype,{value:{value:r},constructor:{value:bt(i.name+"_"+t,function(){})}});l.values[r]=c,l[t]=c}function Be(e){if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e}function Wi(e,t){switch(t){case 2:return function(r){return this.fromWireType(Ze[r>>>2])};case 3:return function(r){return this.fromWireType(Vt[r>>>3])};default:throw new TypeError("Unknown float type: "+e)}}function Li(e,t,r){var i=Ct(r);t=X(t),be(e,{name:t,fromWireType:function(l){return l},toWireType:function(l,c){if(typeof c!="number"&&typeof c!="boolean")throw new TypeError('Cannot convert "'+Be(c)+'" to '+this.name);return c},argPackAdvance:8,readValueFromPointer:Wi(t,i),destructorFunction:null})}function Hi(e,t,r,i,l,c){var f=Jt(t,r);e=X(e),l=ee(i,l),Bt(e,function(){At("Cannot call "+e+" due to unbound types",f)},t-1),ke([],f,function(u){var _=[u[0],null].concat(u.slice(1));return xr(e,Xt(e,_,null,l,c),t-1),[]})}function zi(e,t,r){switch(t){case 0:return r?function(l){return V[l>>>0]}:function(l){return U[l>>>0]};case 1:return r?function(l){return K[l>>>1]}:function(l){return me[l>>>1]};case 2:return r?function(l){return g[l>>>2]}:function(l){return oe[l>>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function Yi(e,t,r,i,l){t=X(t),l===-1&&(l=4294967295);var c=Ct(r),f=function(v){return v};if(i===0){var u=32-8*r;f=function(v){return v<<u>>>u}}var _=t.includes("unsigned");be(e,{name:t,fromWireType:f,toWireType:function(v,T){if(typeof T!="number"&&typeof T!="boolean")throw new TypeError('Cannot convert "'+Be(T)+'" to '+this.name);if(T<i||T>l)throw new TypeError('Passing a number "'+Be(T)+'" from JS side to C/C++ side to an argument of type "'+t+'", which is outside the valid range ['+i+", "+l+"]!");return _?T>>>0:T|0},argPackAdvance:8,readValueFromPointer:zi(t,c,i!==0),destructorFunction:null})}function Gi(e,t,r){var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],l=i[t];function c(f){f=f>>2;var u=oe,_=u[f>>>0],v=u[f+1>>>0];return new l(se,v,_)}r=X(r),be(e,{name:r,fromWireType:c,argPackAdvance:8,readValueFromPointer:c},{ignoreDuplicateRegistrations:!0})}function Bi(e,t,r,i,l,c,f,u,_,v,T,O){r=X(r),c=ee(l,c),u=ee(f,u),v=ee(_,v),O=ee(T,O),ke([e],[t],function(E){E=E[0];var j=new Te(r,E.registeredClass,!1,!1,!0,E,i,c,u,v,O);return[j]})}function qi(e,t){t=X(t);var r=t==="std::string";be(e,{name:t,fromWireType:function(i){var l=oe[i>>>2],c;if(r)for(var f=i+4,u=0;u<=l;++u){var _=i+4+u;if(u==l||U[_>>>0]==0){var v=_-f,T=S(f,v);c===void 0?c=T:(c+=String.fromCharCode(0),c+=T),f=_+1}}else{for(var O=new Array(l),u=0;u<l;++u)O[u]=String.fromCharCode(U[i+4+u>>>0]);c=O.join("")}return Ce(i),c},toWireType:function(i,l){l instanceof ArrayBuffer&&(l=new Uint8Array(l));var c,f=typeof l=="string";f||l instanceof Uint8Array||l instanceof Uint8ClampedArray||l instanceof Int8Array||$("Cannot pass non-string to std::string"),r&&f?c=function(){return P(l)}:c=function(){return l.length};var u=c(),_=ct(4+u+1);if(_>>>=0,oe[_>>>2]=u,r&&f)M(l,_+4,u+1);else if(f)for(var v=0;v<u;++v){var T=l.charCodeAt(v);T>255&&(Ce(_),$("String has UTF-16 code units that do not fit in 8 bits")),U[_+4+v>>>0]=T}else for(var v=0;v<u;++v)U[_+4+v>>>0]=l[v];return i!==null&&i.push(Ce,_),_},argPackAdvance:8,readValueFromPointer:tt,destructorFunction:function(i){Ce(i)}})}function Ji(e,t,r){r=X(r);var i,l,c,f,u;t===2?(i=q,l=J,f=pe,c=function(){return me},u=1):t===4&&(i=he,l=ye,f=He,c=function(){return oe},u=2),be(e,{name:r,fromWireType:function(_){for(var v=oe[_>>>2],T=c(),O,E=_+4,j=0;j<=v;++j){var z=_+4+j*t;if(j==v||T[z>>>u]==0){var G=z-E,Z=i(E,G);O===void 0?O=Z:(O+=String.fromCharCode(0),O+=Z),E=z+t}}return Ce(_),O},toWireType:function(_,v){typeof v!="string"&&$("Cannot pass non-string to C++ string type "+r);var T=f(v),O=ct(4+T+t);return O>>>=0,oe[O>>>2]=T>>u,l(v,O+4,T+t),_!==null&&_.push(Ce,O),O},argPackAdvance:8,readValueFromPointer:tt,destructorFunction:function(_){Ce(_)}})}function Xi(e,t,r,i,l,c){vt[e]={name:X(t),rawConstructor:ee(r,i),rawDestructor:ee(l,c),fields:[]}}function Ki(e,t,r,i,l,c,f,u,_,v){vt[e].fields.push({fieldName:X(t),getterReturnType:r,getter:ee(i,l),getterContext:c,setterArgumentType:f,setter:ee(u,_),setterContext:v})}function Zi(e,t){t=X(t),be(e,{isVoid:!0,name:t,argPackAdvance:0,fromWireType:function(){},toWireType:function(r,i){}})}function le(e){return e||$("Cannot use deleted val. handle = "+e),ae[e].value}function Qi(e,t,r){e=le(e),t=ot(t,"emval::as");var i=[],l=te(i);return g[r>>>2]=l,t.toWireType(i,e)}function Fr(e,t){for(var r=new Array(e),i=0;i<e;++i)r[i]=ot(g[(t>>2)+i>>>0],"parameter "+i);return r}function es(e,t,r,i){e=le(e);for(var l=Fr(t,r),c=new Array(t),f=0;f<t;++f){var u=l[f];c[f]=u.readValueFromPointer(i),i+=u.argPackAdvance}var _=e.apply(void 0,c);return te(_)}function ts(e){var t=[];return g[e>>>2]=te(t),t}var rs={};function at(e){var t=rs[e];return t===void 0?X(e):t}var Ot=[];function ns(e,t,r,i,l){return e=Ot[e],t=le(t),r=at(r),e(t,r,ts(i),l)}function is(e,t,r,i){e=Ot[e],t=le(t),r=at(r),e(t,r,null,i)}function Dr(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function ss(e){return e===0?te(Dr()):(e=at(e),te(Dr()[e]))}function os(e){var t=Ot.length;return Ot.push(e),t}function as(e,t){for(var r=Fr(e,t),i=r[0],l=i.name+"_$"+r.slice(1).map(function(j){return j.name}).join("_")+"$",c=["retType"],f=[i],u="",_=0;_<e-1;++_)u+=(_!==0?", ":"")+"arg"+_,c.push("argType"+_),f.push(r[1+_]);for(var v=wt("methodCaller_"+l),T="return function "+v+`(handle, name, destructors, args) {
`,O=0,_=0;_<e-1;++_)T+="    var arg"+_+" = argType"+_+".readValueFromPointer(args"+(O?"+"+O:"")+`);
`,O+=r[_+1].argPackAdvance;T+="    var rv = handle[name]("+u+`);
`;for(var _=0;_<e-1;++_)r[_+1].deleteObject&&(T+="    argType"+_+".deleteObject(arg"+_+`);
`);i.isVoid||(T+=`    return retType.toWireType(destructors, rv);
`),T+=`};
`,c.push(T);var E=jr(Function,c).apply(null,f);return os(E)}function ls(e){return e=at(e),te(n[e])}function us(e,t){return e=le(e),t=le(t),te(e[t])}function cs(e){e>4&&(ae[e].refcount+=1)}function fs(e,t){return e=le(e),t=le(t),e instanceof t}function _s(e){for(var t="",r=0;r<e;++r)t+=(r!==0?", ":"")+"arg"+r;for(var i="return function emval_allocator_"+e+`(constructor, argTypes, args) {
`,r=0;r<e;++r)i+="var argType"+r+" = requireRegisteredType(Module['HEAP32'][(argTypes >>> 2) + "+r+'], "parameter '+r+`");
var arg`+r+" = argType"+r+`.readValueFromPointer(args);
args += argType`+r+`['argPackAdvance'];
`;return i+="var obj = new constructor("+t+`);
return __emval_register(obj);
}
`,new Function("requireRegisteredType","Module","__emval_register",i)(ot,n,te)}var $r={};function ds(e,t,r,i){e=le(e);var l=$r[t];return l||(l=_s(t),$r[t]=l),l(e,r,i)}function ps(){return te([])}function hs(e){return te(at(e))}function ms(){return te({})}function gs(e){var t=ae[e].value;Lt(t),Zt(e)}function vs(e,t,r){e=le(e),t=le(t),r=le(r),e[t]=r}function ys(e,t){e=ot(e,"_emval_take_value");var r=e.readValueFromPointer(t);return te(r)}function ws(e){return e=le(e),te(typeof e)}function bs(){ze()}var Nr;Nr=function(){return performance.now()};var Ts=!0;function Cs(e,t){var r;if(e===0)r=Date.now();else if((e===1||e===4)&&Ts)r=Nr();else return $n(28),-1;return g[t>>>2]=r/1e3|0,g[t+4>>>2]=r%1e3*1e3*1e3|0,0}var Qt=[];function Es(e,t){Qt.length=0;var r;for(t>>=2;r=U[e++>>>0];){var i=r<105;i&&t&1&&t++,Qt.push(i?Vt[t++>>>1]:g[t>>>0]),++t}return Qt}function As(e,t,r){var i=Es(t,r);return En[e].apply(null,i)}function Os(){return 4294901760}function Ss(e,t,r){U.copyWithin(e>>>0,t>>>0,t+r>>>0)}function Ps(e){try{return o.grow(e-se.byteLength+65535>>>16),hr(o.buffer),1}catch{}}function xs(e){var t=U.length;e=e>>>0;var r=4294901760;if(e>r)return!1;for(var i=1;i<=4;i*=2){var l=t*(1+.2/i);l=Math.min(l,e+100663296);var c=Math.min(r,Re(Math.max(e,l),65536)),f=Ps(c);if(f)return!0}return!1}var er={};function Rs(){return B||"./this.program"}function lt(){if(!lt.strings){var e=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:Rs()};for(var r in er)er[r]===void 0?delete t[r]:t[r]=er[r];var i=[];for(var r in t)i.push(r+"="+t[r]);lt.strings=i}return lt.strings}function ks(e,t){var r=0;return lt().forEach(function(i,l){var c=t+r;g[e+l*4>>>2]=c,we(i,c),r+=i.length+1}),0}function js(e,t){var r=lt();g[e>>>2]=r.length;var i=0;return r.forEach(function(l){i+=l.length+1}),g[t>>>2]=i,0}function Fs(e){return 0}function Ds(e,t,r,i){var l=ce.getStreamFromFD(e),c=ce.doReadv(l,t,r);return g[i>>>2]=c,0}function $s(e,t,r,i,l){}function Ns(e,t,r,i){for(var l=0,c=0;c<r;c++){for(var f=g[t+c*8>>>2],u=g[t+(c*8+4)>>>2],_=0;_<u;_++)ce.printChar(e,U[f+_>>>0]);l+=u}return g[i>>>2]=l,0}function Is(e){It(e)}function qe(e){return e%4==0&&(e%100!=0||e%400==0)}function ut(e,t){for(var r=0,i=0;i<=t;r+=e[i++]);return r}var Ve=[31,29,31,30,31,30,31,31,30,31,30,31],Ue=[31,28,31,30,31,30,31,31,30,31,30,31];function Fe(e,t){for(var r=new Date(e.getTime());t>0;){var i=qe(r.getFullYear()),l=r.getMonth(),c=(i?Ve:Ue)[l];if(t>c-r.getDate())t-=c-r.getDate()+1,r.setDate(1),l<11?r.setMonth(l+1):(r.setMonth(0),r.setFullYear(r.getFullYear()+1));else return r.setDate(r.getDate()+t),r}return r}function Ir(e,t,r,i){var l=g[i+40>>>2],c={tm_sec:g[i>>>2],tm_min:g[i+4>>>2],tm_hour:g[i+8>>>2],tm_mday:g[i+12>>>2],tm_mon:g[i+16>>>2],tm_year:g[i+20>>>2],tm_wday:g[i+24>>>2],tm_yday:g[i+28>>>2],tm_isdst:g[i+32>>>2],tm_gmtoff:g[i+36>>>2],tm_zone:l?S(l):""},f=S(r),u={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var _ in u)f=f.replace(new RegExp(_,"g"),u[_]);var v=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],T=["January","February","March","April","May","June","July","August","September","October","November","December"];function O(p,b,Y){for(var F=typeof p=="number"?p.toString():p||"";F.length<b;)F=Y[0]+F;return F}function E(p,b){return O(p,b,"0")}function j(p,b){function Y(Q){return Q<0?-1:Q>0?1:0}var F;return(F=Y(p.getFullYear()-b.getFullYear()))===0&&(F=Y(p.getMonth()-b.getMonth()))===0&&(F=Y(p.getDate()-b.getDate())),F}function z(p){switch(p.getDay()){case 0:return new Date(p.getFullYear()-1,11,29);case 1:return p;case 2:return new Date(p.getFullYear(),0,3);case 3:return new Date(p.getFullYear(),0,2);case 4:return new Date(p.getFullYear(),0,1);case 5:return new Date(p.getFullYear()-1,11,31);case 6:return new Date(p.getFullYear()-1,11,30)}}function G(p){var b=Fe(new Date(p.tm_year+1900,0,1),p.tm_yday),Y=new Date(b.getFullYear(),0,4),F=new Date(b.getFullYear()+1,0,4),Q=z(Y),ne=z(F);return j(Q,b)<=0?j(ne,b)<=0?b.getFullYear()+1:b.getFullYear():b.getFullYear()-1}var Z={"%a":function(p){return v[p.tm_wday].substring(0,3)},"%A":function(p){return v[p.tm_wday]},"%b":function(p){return T[p.tm_mon].substring(0,3)},"%B":function(p){return T[p.tm_mon]},"%C":function(p){var b=p.tm_year+1900;return E(b/100|0,2)},"%d":function(p){return E(p.tm_mday,2)},"%e":function(p){return O(p.tm_mday,2," ")},"%g":function(p){return G(p).toString().substring(2)},"%G":function(p){return G(p)},"%H":function(p){return E(p.tm_hour,2)},"%I":function(p){var b=p.tm_hour;return b==0?b=12:b>12&&(b-=12),E(b,2)},"%j":function(p){return E(p.tm_mday+ut(qe(p.tm_year+1900)?Ve:Ue,p.tm_mon-1),3)},"%m":function(p){return E(p.tm_mon+1,2)},"%M":function(p){return E(p.tm_min,2)},"%n":function(){return`
`},"%p":function(p){return p.tm_hour>=0&&p.tm_hour<12?"AM":"PM"},"%S":function(p){return E(p.tm_sec,2)},"%t":function(){return"	"},"%u":function(p){return p.tm_wday||7},"%U":function(p){var b=new Date(p.tm_year+1900,0,1),Y=b.getDay()===0?b:Fe(b,7-b.getDay()),F=new Date(p.tm_year+1900,p.tm_mon,p.tm_mday);if(j(Y,F)<0){var Q=ut(qe(F.getFullYear())?Ve:Ue,F.getMonth()-1)-31,ne=31-Y.getDate(),_e=ne+Q+F.getDate();return E(Math.ceil(_e/7),2)}return j(Y,b)===0?"01":"00"},"%V":function(p){var b=new Date(p.tm_year+1900,0,4),Y=new Date(p.tm_year+1901,0,4),F=z(b),Q=z(Y),ne=Fe(new Date(p.tm_year+1900,0,1),p.tm_yday);if(j(ne,F)<0)return"53";if(j(Q,ne)<=0)return"01";var _e;return F.getFullYear()<p.tm_year+1900?_e=p.tm_yday+32-F.getDate():_e=p.tm_yday+1-F.getDate(),E(Math.ceil(_e/7),2)},"%w":function(p){return p.tm_wday},"%W":function(p){var b=new Date(p.tm_year,0,1),Y=b.getDay()===1?b:Fe(b,b.getDay()===0?1:7-b.getDay()+1),F=new Date(p.tm_year+1900,p.tm_mon,p.tm_mday);if(j(Y,F)<0){var Q=ut(qe(F.getFullYear())?Ve:Ue,F.getMonth()-1)-31,ne=31-Y.getDate(),_e=ne+Q+F.getDate();return E(Math.ceil(_e/7),2)}return j(Y,b)===0?"01":"00"},"%y":function(p){return(p.tm_year+1900).toString().substring(2)},"%Y":function(p){return p.tm_year+1900},"%z":function(p){var b=p.tm_gmtoff,Y=b>=0;return b=Math.abs(b)/60,b=b/60*100+b%60,(Y?"+":"-")+String("0000"+b).slice(-4)},"%Z":function(p){return p.tm_zone},"%%":function(){return"%"}};for(var _ in Z)f.includes(_)&&(f=f.replace(new RegExp(_,"g"),Z[_](c)));var R=Mr(f,!1);return R.length>t?0:(ue(R,e),R.length-1)}function Ms(e,t,r,i){return Ir(e,t,r,i)}function fe(e){return parseInt(e)}function Vs(e,t,r){for(var i=S(t),l="\\!@#$^&*()+=-[]/{}|:<>?,.",c=0,f=l.length;c<f;++c)i=i.replace(new RegExp("\\"+l[c],"g"),"\\"+l[c]);var u={"%A":"%a","%B":"%b","%c":"%a %b %d %H:%M:%S %Y","%D":"%m\\/%d\\/%y","%e":"%d","%F":"%Y-%m-%d","%h":"%b","%R":"%H\\:%M","%r":"%I\\:%M\\:%S\\s%p","%T":"%H\\:%M\\:%S","%x":"%m\\/%d\\/(?:%y|%Y)","%X":"%H\\:%M\\:%S"};for(var _ in u)i=i.replace(_,u[_]);var v={"%a":"(?:Sun(?:day)?)|(?:Mon(?:day)?)|(?:Tue(?:sday)?)|(?:Wed(?:nesday)?)|(?:Thu(?:rsday)?)|(?:Fri(?:day)?)|(?:Sat(?:urday)?)","%b":"(?:Jan(?:uary)?)|(?:Feb(?:ruary)?)|(?:Mar(?:ch)?)|(?:Apr(?:il)?)|May|(?:Jun(?:e)?)|(?:Jul(?:y)?)|(?:Aug(?:ust)?)|(?:Sep(?:tember)?)|(?:Oct(?:ober)?)|(?:Nov(?:ember)?)|(?:Dec(?:ember)?)","%C":"\\d\\d","%d":"0[1-9]|[1-9](?!\\d)|1\\d|2\\d|30|31","%H":"\\d(?!\\d)|[0,1]\\d|20|21|22|23","%I":"\\d(?!\\d)|0\\d|10|11|12","%j":"00[1-9]|0?[1-9](?!\\d)|0?[1-9]\\d(?!\\d)|[1,2]\\d\\d|3[0-6]\\d","%m":"0[1-9]|[1-9](?!\\d)|10|11|12","%M":"0\\d|\\d(?!\\d)|[1-5]\\d","%n":"\\s","%p":"AM|am|PM|pm|A\\.M\\.|a\\.m\\.|P\\.M\\.|p\\.m\\.","%S":"0\\d|\\d(?!\\d)|[1-5]\\d|60","%U":"0\\d|\\d(?!\\d)|[1-4]\\d|50|51|52|53","%W":"0\\d|\\d(?!\\d)|[1-4]\\d|50|51|52|53","%w":"[0-6]","%y":"\\d\\d","%Y":"\\d\\d\\d\\d","%%":"%","%t":"\\s"},T={JAN:0,FEB:1,MAR:2,APR:3,MAY:4,JUN:5,JUL:6,AUG:7,SEP:8,OCT:9,NOV:10,DEC:11},O={SUN:0,MON:1,TUE:2,WED:3,THU:4,FRI:5,SAT:6},E={MON:0,TUE:1,WED:2,THU:3,FRI:4,SAT:5,SUN:6};for(var j in v)i=i.replace(j,"("+j+v[j]+")");for(var z=[],c=i.indexOf("%");c>=0;c=i.indexOf("%"))z.push(i[c+1]),i=i.replace(new RegExp("\\%"+i[c+1],"g"),"");var G=new RegExp("^"+i,"i").exec(S(e));function Z(){function De($e,nr,qr){return typeof $e!="number"||isNaN($e)?nr:$e>=nr?$e<=qr?$e:qr:nr}return{year:De(g[r+20>>>2]+1900,1970,9999),month:De(g[r+16>>>2],0,11),day:De(g[r+12>>>2],1,31),hour:De(g[r+8>>>2],0,23),min:De(g[r+4>>>2],0,59),sec:De(g[r>>>2],0,59)}}if(G){var R=Z(),p,b=function(De){var $e=z.indexOf(De);if($e>=0)return G[$e+1]};if((p=b("S"))&&(R.sec=fe(p)),(p=b("M"))&&(R.min=fe(p)),p=b("H"))R.hour=fe(p);else if(p=b("I")){var Y=fe(p);(p=b("p"))&&(Y+=p.toUpperCase()[0]==="P"?12:0),R.hour=Y}if(p=b("Y"))R.year=fe(p);else if(p=b("y")){var F=fe(p);(p=b("C"))?F+=fe(p)*100:F+=F<69?2e3:1900,R.year=F}if((p=b("m"))?R.month=fe(p)-1:(p=b("b"))&&(R.month=T[p.substring(0,3).toUpperCase()]||0),p=b("d"))R.day=fe(p);else if(p=b("j"))for(var Q=fe(p),ne=qe(R.year),_e=0;_e<12;++_e){var Gr=ut(ne?Ve:Ue,_e-1);Q<=Gr+(ne?Ve:Ue)[_e]&&(R.day=Q-Gr)}else if(p=b("a")){var Br=p.substring(0,3).toUpperCase();if(p=b("U")){var ft=O[Br],_t=fe(p),Se=new Date(R.year,0,1),Pe;Se.getDay()===0?Pe=Fe(Se,ft+7*(_t-1)):Pe=Fe(Se,7-Se.getDay()+ft+7*(_t-1)),R.day=Pe.getDate(),R.month=Pe.getMonth()}else if(p=b("W")){var ft=E[Br],_t=fe(p),Se=new Date(R.year,0,1),Pe;Se.getDay()===1?Pe=Fe(Se,ft+7*(_t-1)):Pe=Fe(Se,7-Se.getDay()+1+ft+7*(_t-1)),R.day=Pe.getDate(),R.month=Pe.getMonth()}}var Ee=new Date(R.year,R.month,R.day,R.hour,R.min,R.sec,0);return g[r>>>2]=Ee.getSeconds(),g[r+4>>>2]=Ee.getMinutes(),g[r+8>>>2]=Ee.getHours(),g[r+12>>>2]=Ee.getDate(),g[r+16>>>2]=Ee.getMonth(),g[r+20>>>2]=Ee.getFullYear()-1900,g[r+24>>>2]=Ee.getDay(),g[r+28>>>2]=ut(qe(Ee.getFullYear())?Ve:Ue,Ee.getMonth()-1)+Ee.getDate()-1,g[r+32>>>2]=0,e+Mr(G[0]).length-1}return 0}Tr=n.InternalError=Ht(Error,"InternalError"),ni(),Ge=n.BindingError=Ht(Error,"BindingError"),_i(),Si(),Ci(),Rr=n.UnboundTypeError=Ht(Error,"UnboundTypeError"),Ni();function Mr(e,t,r){var i=r>0?r:P(e)+1,l=new Array(i),c=C(e,l,0,l.length);return t&&(l.length=c),l}var Us={a:On,i:Sn,j:kn,Z:Dn,L:Nn,ia:In,ja:Mn,M:Vn,ea:Un,aa:Wn,ca:Gn,$:Bn,ba:Jn,N:Xn,da:Kn,ga:Zn,E:ti,U:ri,la:ii,p:ki,v:ji,d:Fi,ka:Ii,R:Vi,u:Ui,O:Li,o:Hi,z:Yi,y:Gi,w:Bi,P:qi,I:Ji,F:Xi,x:Ki,ma:Zi,k:Qi,pa:es,s:ns,q:is,b:Zt,r:ss,l:as,C:ls,m:us,e:cs,S:fs,t:ds,G:ps,n:hs,J:ms,g:gs,A:vs,h:ys,B:ws,f:bs,Q:Cs,c:As,_:Os,V:Ss,H:xs,X:ks,Y:js,D:Fs,ha:Ds,T:$s,fa:Ns,K:Is,oa:Ir,W:Ms,na:Vs},jo=Cn(),Ws=n.___wasm_call_ctors=function(){return(Ws=n.___wasm_call_ctors=n.asm.ra).apply(null,arguments)},ct=n._malloc=function(){return(ct=n._malloc=n.asm.sa).apply(null,arguments)},Ce=n._free=function(){return(Ce=n._free=n.asm.ta).apply(null,arguments)},Ls=n._main=function(){return(Ls=n._main=n.asm.ua).apply(null,arguments)},Vr=n.___errno_location=function(){return(Vr=n.___errno_location=n.asm.wa).apply(null,arguments)},Ur=n.___getTypeName=function(){return(Ur=n.___getTypeName=n.asm.xa).apply(null,arguments)},Hs=n.___embind_register_native_and_builtin_types=function(){return(Hs=n.___embind_register_native_and_builtin_types=n.asm.ya).apply(null,arguments)},Je=n.__get_tzname=function(){return(Je=n.__get_tzname=n.asm.za).apply(null,arguments)},Wr=n.__get_daylight=function(){return(Wr=n.__get_daylight=n.asm.Aa).apply(null,arguments)},Lr=n.__get_timezone=function(){return(Lr=n.__get_timezone=n.asm.Ba).apply(null,arguments)},tr=n.stackAlloc=function(){return(tr=n.stackAlloc=n.asm.Ca).apply(null,arguments)},Hr=n._memalign=function(){return(Hr=n._memalign=n.asm.Da).apply(null,arguments)},zs=n.dynCall_ji=function(){return(zs=n.dynCall_ji=n.asm.Ea).apply(null,arguments)},Ys=n.dynCall_viij=function(){return(Ys=n.dynCall_viij=n.asm.Fa).apply(null,arguments)},Gs=n.dynCall_viiij=function(){return(Gs=n.dynCall_viiij=n.asm.Ga).apply(null,arguments)},Bs=n.dynCall_viiijj=function(){return(Bs=n.dynCall_viiijj=n.asm.Ha).apply(null,arguments)},qs=n.dynCall_viiji=function(){return(qs=n.dynCall_viiji=n.asm.Ia).apply(null,arguments)},Js=n.dynCall_viijji=function(){return(Js=n.dynCall_viijji=n.asm.Ja).apply(null,arguments)},Xs=n.dynCall_viijj=function(){return(Xs=n.dynCall_viijj=n.asm.Ka).apply(null,arguments)},Ks=n.dynCall_viijij=function(){return(Ks=n.dynCall_viijij=n.asm.La).apply(null,arguments)},Zs=n.dynCall_viiiijii=function(){return(Zs=n.dynCall_viiiijii=n.asm.Ma).apply(null,arguments)},Qs=n.dynCall_viji=function(){return(Qs=n.dynCall_viji=n.asm.Na).apply(null,arguments)},eo=n.dynCall_vijjji=function(){return(eo=n.dynCall_vijjji=n.asm.Oa).apply(null,arguments)},to=n.dynCall_jiji=function(){return(to=n.dynCall_jiji=n.asm.Pa).apply(null,arguments)},ro=n.dynCall_iiiiij=function(){return(ro=n.dynCall_iiiiij=n.asm.Qa).apply(null,arguments)},no=n.dynCall_iiiiijj=function(){return(no=n.dynCall_iiiiijj=n.asm.Ra).apply(null,arguments)},io=n.dynCall_iiiiiijj=function(){return(io=n.dynCall_iiiiiijj=n.asm.Sa).apply(null,arguments)},so=n.dynCall_viijii=function(){return(so=n.dynCall_viijii=n.asm.Ta).apply(null,arguments)},St;function zr(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}var oo=!1;et=function e(){St||rr(),St||(et=e)};function ao(e){var t=n._main;e=e||[];var r=e.length+1,i=tr((r+1)*4);g[i>>>2]=mt(B);for(var l=1;l<r;l++)g[(i>>2)+l>>>0]=mt(e[l-1]);g[(i>>2)+r>>>0]=0;try{var c=t(r,i);return lo(c,!0),c}catch(f){return An(f)}finally{oo=!0}}function rr(e){if(e=e||L,Ie>0||(fn(),Ie>0))return;function t(){St||(St=!0,n.calledRun=!0,!a&&(_n(),dn(),y(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),Yr&&ao(e),hn()))}n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),t()},1)):t()}n.run=rr;function lo(e,t){d=e,yr()||pn(),uo(e)}function uo(e){d=e,yr()||(n.onExit&&n.onExit(e),a=!0),de(e,new zr(e))}if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();var Yr=!0;return n.noInitialRun&&(Yr=!1),rr(),s.ready}}(),sr=vo;var xt={};mo(xt,{COLUMN_SEPARATOR_STRING:()=>Ae,CONFIG_ALIASES:()=>dt,CONFIG_VALID_KEYS:()=>Kr,DATA_TYPES:()=>yo,FILTER_OPERATORS:()=>D,SORT_ORDERS:()=>bo,SORT_ORDER_IDS:()=>To,TYPE_AGGREGATES:()=>Co,TYPE_FILTERS:()=>Oo});var yo={integer:"integer",float:"float",string:"string",boolean:"boolean",date:"date",datetime:"datetime",object:"object"},dt={row_pivot:"group_by","row-pivot":"group_by","row-pivots":"group_by",col_pivot:"split_by",col_pivots:"split_by",column_pivot:"split_by","column-pivot":"split_by","column-pivots":"split_by",filters:"filter",sorts:"sort"},Kr=["viewport","group_by","split_by","aggregates","columns","filter","sort","computed_columns","expressions","group_by_depth","split_by_depth","filter_op"],Zr=["any","avg","abs sum","count","distinct count","dominant","first by index","last by index","last minus first","last","high","join","low","high minus low","mean","median","pct sum parent","pct sum grand total","stddev","sum","sum abs","sum not null","unique","var"],or=["any","count","distinct count","distinct leaf","dominant","first by index","join","last by index","last","unique"],wo=["any","count","distinct count","distinct leaf","dominant","first by index","last by index","last","unique"],bo=["none","asc","desc","col asc","col desc","asc abs","desc abs","col asc abs","col desc abs"],To=[2,0,1,0,1,3,4,3,4],Co={string:or,float:Zr,integer:Zr,boolean:wo,datetime:or,date:or},D={lessThan:"<",greaterThan:">",equals:"==",lessThanOrEquals:"<=",greaterThanOrEquals:">=",doesNotEqual:"!=",isNull:"is null",isNotNull:"is not null",isIn:"in",isNotIn:"not in",contains:"contains",bitwiseAnd:"&",bitwiseOr:"|",and:"and",or:"or",beginsWith:"begins with",endsWith:"ends with"},Eo=[D.bitwiseAnd,D.bitwiseOr,D.equals,D.doesNotEqual,D.or,D.and,D.isNull,D.isNotNull],Qr=[D.lessThan,D.greaterThan,D.equals,D.lessThanOrEquals,D.greaterThanOrEquals,D.doesNotEqual,D.isNull,D.isNotNull],Ao=[D.equals,D.contains,D.doesNotEqual,D.isIn,D.isNotIn,D.beginsWith,D.endsWith,D.isNull,D.isNotNull],en=[D.lessThan,D.greaterThan,D.equals,D.lessThanOrEquals,D.greaterThanOrEquals,D.doesNotEqual,D.isNull,D.isNotNull],Ae="|",Oo={string:Ao,float:Qr,integer:Qr,boolean:Eo,datetime:en,date:en};var Dt=ir(kt());function jt(h){if(h>=1&&h<=8)return"integer";if(h===19)return"string";if(h===10||h===9)return"float";if(h===11)return"boolean";if(h===12)return"datetime";if(h===13)return"date";console.warn(`Unknown type for value ${h} with JS type ${typeof h}`)}function lr(h){let s=h;do for(let n of Object.getOwnPropertyNames(s)){let y=h[n];n!=="constructor"&&typeof y=="function"&&(h[n]=y.bind(h))}while(s=s!==Object&&Object.getPrototypeOf(s))}String.prototype.includes||(String.prototype.includes=function(h,s){return typeof s!="number"&&(s=0),s+h.length>this.length?!1:this.indexOf(h,s)!==-1});Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(h,s){if(this==null)throw new TypeError('"this" is null or not defined');var n=Object(this),y=n.length>>>0;if(y===0)return!1;var N=s|0,k=Math.max(N>=0?N:y-Math.abs(N),0);function x(L,B){return L===B||typeof L=="number"&&typeof B=="number"&&isNaN(L)&&isNaN(B)}for(;k<y;){if(x(n[k],h))return!0;k++}return!1}});var sn=ir(kt()),ur=class{constructor(){this.data_formats={row:0,column:1,schema:2},this.format=void 0,this.data=void 0,this.names=void 0,this.types=void 0,this.row_count=void 0}is_format(s){if(Array.isArray(s))return this.data_formats.row;if(Array.isArray(s[Object.keys(s)[0]]))return this.data_formats.column;if(typeof s[Object.keys(s)[0]]=="string"||typeof s[Object.keys(s)[0]]=="function")return this.data_formats.schema;throw`Could not determine data format for ${JSON.stringify(s)}, with JS typeof ${typeof s}`}count_rows(s){return this.format===this.data_formats.row?s.length:this.format===this.data_formats.column?s[Object.keys(s)[0]].length:0}get_format(){return this.format}get(s,n){let y;if(this.format===this.data_formats.row){let N=this.data[n];N.hasOwnProperty(s)&&(y=N[s])}else if(this.format===this.data_formats.column)this.data.hasOwnProperty(s)&&(y=this.data[s][n]);else if(this.format===this.data_formats.schema)y=void 0;else throw`Could not get() from dataset - ${this.data} is poorly formatted.`;return y}marshal(s,n,y){let N=this.names[s],k=So(this.get(N,n));if(k===null)return null;if(typeof k!="undefined"){switch(jt(y.value)){case"float":case"integer":{k=Number(k);break}case"boolean":{typeof k=="string"?k.toLowerCase()==="true"?k=!0:k=!1:k=!!k;break}case"datetime":case"date":break;default:k+=""}return k}}clean(){this.names=void 0,this.types=void 0}init(s){this.data=s,this.format=this.is_format(this.data),this.row_count=this.count_rows(this.data);let n={};if(this.format===this.data_formats.row)s.length>0?this.names=Object.keys(s[0]):this.clean.names=[];else if(this.format===this.data_formats.column)this.names=Object.keys(s);else if(this.format===this.data_formats.schema){this.names=Object.keys(s);for(let y of this.names){let N=(0,sn.get_type_config)(s[y]);N.type&&(console.debug(`Converting "${s[y]}" to "${N.type}"`),n[y]=s[y],s[y]=N.type)}}else throw`Could not initialize - failed to determine format for ${s}`;return n}};function So(h){return h===null||h==="null"?null:h===void 0||h==="undefined"?void 0:h}var cr=function(h){let s=[];for(let n=0;n<h.size();n++){let y=h.get(n);s.push(y)}return h.delete(),s},fr=function(h){let s={},n=h.keys();for(let y=0;y<n.size();y++){let N=n.get(y);s[N]=h.get(N)}return h.delete(),n.delete(),s},Xe=function(h,s){for(let n of s)h.push_back(n);return h};var on=ir(kt());function Po(h){let s={};return typeof h!="string"?Object.getOwnPropertyNames(h).forEach(n=>{s[n]=h[n]},h):s.message=h,s}var Ft=class{constructor(s){this.perspective=s,this._tables={},this._views={},this._callback_cache=new Map}init(s){s.config&&(0,on.override_config)(s.config),s.data=["wait_for_response"],this.post(s)}post(s){throw new Error(`Posting ${s} failed - post() not implemented!`)}process(s,n){switch(s.cmd){case"init_profile_thread":this.perspective.initialize_profile_thread();break;case"memory_usage":this.post({id:s.id,data:this.perspective.memory_usage()});break;case"init":this.init(s);break;case"table":if(typeof s.args[0]=="undefined")this._tables[s.name]=[];else try{let x=this._tables[s.name],L=this.perspective.table(s.args[0],s.options);if(L&&L.then)L.then(B=>{if(this._tables[s.name]=B,x)for(let de of x)this.process(de);this.post({id:s.id,data:s.name})}).catch(B=>this.process_error(s,B));else{if(this._tables[s.name]=L,x)for(let B of x)this.process(B);this.post({id:s.id,data:s.name})}}catch(x){this.process_error(s,x);return}break;case"table_generate":(0,eval)(s.args)(function(x){this._tables[s.name]=x,this.post({id:s.id,data:"created!"})});break;case"table_execute":(0,eval)(s.f)(this._tables[s.name]);break;case"table_method":case"view_method":this.process_method_call(s);break;case"view":let k=this._tables[s.table_name];if(k&&Array.isArray(k))k.push(s),this._views[s.view_name]=[];else try{let x=this._views[s.view_name],L=this._tables[s.table_name].view(s.config);if(L&&L.then)L.then(B=>{if(this._views[s.view_name]=B,this._views[s.view_name].client_id=n,x)for(let de of x)this.process(de);this.post({id:s.id,data:s.view_name})}).catch(B=>this.process_error(s,B));else{if(this._views[s.view_name]=L,this._views[s.view_name].client_id=n,x)for(let B of x)this.process(B);this.post({id:s.id,data:s.view_name})}}catch(x){this.process_error(s,x);return}break}}process_subscribe(s,n){try{let y;s.method.slice(0,2)==="on"?(y=N=>{let k={id:s.id,data:N};try{if(s.args&&s.args[0]&&s.method==="on_update"&&s.args[0].mode==="row"){this.post(k,[N.delta]);return}this.post(k)}catch{console.error(`Removing failed callback to \`${s.method}()\` (presumably due to failed connection)`);let L=s.method.substring(3);n[`remove_${L}`](y)}},s.callback_id&&this._callback_cache.set(s.callback_id,y)):s.callback_id&&(y=this._callback_cache.get(s.callback_id),this._callback_cache.delete(s.callback_id)),y?n[s.method](y,...s.args):console.error(`Callback not found for remote call "${JSON.stringify(s)}"`)}catch(y){this.process_error(s,y);return}}process_method_call(s){let n,y,N=s.view_name||s.name;if(s.cmd==="table_method"?n=this._tables[N]:n=this._views[N],!n&&s.cmd==="view_method"){this.process_error(s,{message:"View method cancelled"});return}if(n&&n.push){n.push(s);return}try{if(s.subscribe){this.process_subscribe(s,n);return}else y=n[s.method].apply(n,s.args),y instanceof Promise?y.then(k=>this.process_method_call_response(s,k)).catch(k=>this.process_error(s,k)):this.process_method_call_response(s,y)}catch(k){this.process_error(s,k);return}}process_method_call_response(s,n){s.method==="delete"&&delete this._views[s.name],s.method==="to_arrow"?this.post({id:s.id,data:n},[n]):this.post({id:s.id,data:n})}process_error(s,n){this.post({id:s.id,error:Po(n)})}clear_views(s){for(let n of Object.keys(this._views))if(this._views[n].client_id===s){try{this._views[n].delete()}catch(y){console.error(y)}delete this._views[n]}console.debug(`GC ${Object.keys(this._views).length} views in memory`)}};var xo={initDataValue:()=>[],initRowValue:()=>({}),initColumnValue:(h,s,n)=>s[n]=[],setColumnValue:(h,s,n,y)=>s[n]=y,addColumnValue:(h,s,n,y)=>s[n].unshift(y),addRow:(h,s)=>h.push(s),formatData:h=>h,slice:(h,s)=>h.slice(s)},Ro={initDataValue:()=>new Object,initRowValue:()=>{},setColumnValue:(h,s,n,y)=>{h[n]=h[n]||[],h[n].push(y)},addColumnValue:(h,s,n,y)=>{h[n]=h[n]||[],h[n][h[n].length-1].unshift(y)},initColumnValue:(h,s,n)=>{h[n]=h[n]||[],h[n].push([])},addRow:()=>{},formatData:h=>h,slice:(h,s)=>{let n={};for(let y in h)n[y]=h[y].slice(s);return n}},_r={jsonFormatter:xo,jsonTableFormatter:Ro};self.performance===void 0&&(self.performance={now:Date.now});typeof self!="undefined"&&self.performance===void 0&&(self.performance={now:Date.now});var $t=new Set;function dr(h){let s=h,n=new ur,y=["zero","one","two"],N={};function k(o,a){N[a]||(N[a]=o,setTimeout(()=>x(a)))}function x(o){let a=N[o];a&&(a._process(),L(o))}function L(o){delete N[o]}function B(){let o=performance.memory?JSON.parse(JSON.stringify(performance.memory,["totalJSHeapSize","usedJSHeapSize","jsHeapSizeLimit"])):process.memoryUsage();return o.wasmHeap=s.HEAP8.length,o}function de(o,a,d,m,w,A,S,C,M){d||(d=""),m||(m=4294967295),a=s.make_table(a,o,m,d,w,A,S,C,M);let P=a.get_pool(),W=a.get_id();return A||w==s.t_op.OP_DELETE?k(P,W):P._process(),a}function I(o,a,d,m,w){this.name=w,this._View=void 0,this.table=o,this.config=d||{},this.view_config=m||new m,this.is_unit_context=this.table.index===""&&a===0&&this.view_config.group_by.length===0&&this.view_config.split_by.length===0&&this.view_config.filter.length===0&&this.view_config.sort.length===0&&this.view_config.expressions.length===0,this.is_unit_context?this._View=s.make_view_unit(o._Table,w,Ae,this.view_config,null):a===0?this._View=s.make_view_zero(o._Table,w,Ae,this.view_config,null):a===1?this._View=s.make_view_one(o._Table,w,Ae,this.view_config,null):a===2&&(this._View=s.make_view_two(o._Table,w,Ae,this.view_config,null)),this.ctx=this._View.get_context(),this.column_only=this._View.is_column_only(),this.update_callbacks=this.table.update_callbacks,this.overridden_types=this.table.overridden_types,this._delete_callbacks=[],lr(this)}I.prototype.get_config=function(){return JSON.parse(JSON.stringify(this.config))},I.prototype.delete=function(){L(this.table.get_id()),this._View.delete(),this.ctx.delete(),this.table.views.splice(this.table.views.indexOf(this),1),this.table=void 0;let o=0,a=0;for(;o<this.update_callbacks.length;){let d=this.update_callbacks[o];d.view!==this&&(this.update_callbacks[a++]=d),o++}this.update_callbacks.length=a,this._delete_callbacks.forEach(d=>d())},I.prototype.sides=function(){return this._View.sides()},I.prototype._num_hidden=function(){let o=0;for(let a of this.config.sort)this.config.columns.indexOf(a[0])===-1&&o++;return o};function We(o){let a=[];for(let d=0;d<o.size();d++){let m=o.get(d);a.push(s.scalar_to_val(m,!1,!0)),m.delete()}return o.delete(),a}let re=function(o){let a=[];for(let d=0;d<o.size();d++){let m=o.get(d);a.push(We(m))}return o.delete(),a};I.prototype.schema=function(o=!0){let a=fr(this._View.schema());if(o)for(let d of Object.keys(a)){let m=d.split(Ae);m=m[m.length-1],this.overridden_types[m]&&(0,Dt.get_type_config)(this.overridden_types[m]).type===a[d]&&(a[d]=this.overridden_types[m])}return a},I.prototype.expression_schema=function(o=!0){let a=fr(this._View.expression_schema());if(o)for(let d of Object.keys(a)){let m=d.split(Ae);m=m[m.length-1],this.overridden_types[m]&&(0,Dt.get_type_config)(this.overridden_types[m]).type===a[d]&&(a[d]=this.overridden_types[m])}return a},I.prototype._column_names=function(o=!1,a=0){return re(this._View.column_names(o,a)).map(d=>d.join(Ae))},I.prototype.column_paths=function(){return re(this._View.column_paths()).map(o=>o.join(Ae))},I.prototype.get_data_slice=function(o,a,d,m){if(this.is_unit_context)return s.get_data_slice_unit(this._View,o,a,d,m);{let w=this.sides(),A=y[w];return s[`get_data_slice_${A}`](this._View,o,a,d,m)}};let Ke=function(o){o=o||{};let a=this._View.num_columns()+(this.sides()===0?0:1),d=this._View.num_rows(),m=this._num_hidden(),w=this.sides()>0||this.column_only?1:0,A=this.config.viewport?this.config.viewport:{},S=o.start_row||(A.top?A.top:0),C=Math.min(d,o.end_row!==void 0?o.end_row:A.height?S+A.height:d),M=o.start_col||(A.left?A.left:0),P=Math.min(a,(o.end_col!==void 0?o.end_col+w:A.width?M+A.width:a)*(m+1));return o.start_row=Math.floor(S),o.end_row=Math.ceil(C),o.start_col=Math.floor(M),o.end_col=Math.ceil(P),o};I.prototype.get_min_max=function(o){if(this.is_unit_context)return s.get_min_max_unit(this._View,o);{let a=this.sides(),d=y[a];return s[`get_min_max_${d}`](this._View,o)}};let pt=function(o,a){x(this.table.get_id()),o=Ke.bind(this)(o);let d=o.start_row,m=o.end_row,w=o.start_col,A=o.end_col,S=this._num_hidden(),C=o.formatted,M=!!o.index,P=!!o.id,W=!!o.leaves_only,q=this.sides(),J=q!==0&&!this.column_only,pe=y[q],he;this.is_unit_context?he=s.get_from_data_slice_unit:he=s[`get_from_data_slice_${pe}`];let ye=this.get_data_slice(d,m,w,A),He=ye.get_column_names(),ht=re(He).map(we=>we.join(Ae)),mt=this.schema(),ue=a.initDataValue();for(let we=d;we<m;we++){let Re=J?ye.get_row_path(we):void 0;if(J&&W&&Re.size()<this.config.group_by.length){Re.delete();continue}let se=a.initRowValue();P&&a.initColumnValue(ue,se,"__ID__");for(let V=w;V<A;V++){let U=ht[V],K=mt[U],me=(0,Dt.get_type_config)(K);if(V===w&&q!==0){if(!this.column_only){a.initColumnValue(ue,se,"__ROW_PATH__");for(let g=0;g<Re.size();g++){let oe=Re.get(g),Ze=s.scalar_to_val(oe,!1,!1);oe.delete(),a.addColumnValue(ue,se,"__ROW_PATH__",Ze),P&&a.addColumnValue(ue,se,"__ID__",Ze)}}}else{if((V-(q>0?1:0))%(this.config.columns.length+S)>=this.config.columns.length)continue;{let g=he(ye,we,V);C&&g!==null&&g!==void 0&&(K==="datetime"||K==="date")&&(g=new Date(g),g=g.toLocaleString("en-us",me.format)),a.setColumnValue(ue,se,U,g)}}}if(M){let V=ye.get_pkeys(we,0);a.initColumnValue(ue,se,"__INDEX__");for(let U=0;U<V.size();U++){let K=V.get(U),me=s.scalar_to_val(K,!1,!1);K.delete(),a.addColumnValue(ue,se,"__INDEX__",me)}V.delete()}if(P&&q===0){let V=ye.get_pkeys(we,0);for(let U=0;U<V.size();U++){let K=V.get(U),me=s.scalar_to_val(K,!1,!1);K.delete(),a.addColumnValue(ue,se,"__ID__",me)}V.delete()}Re&&Re.delete(),a.addRow(ue,se)}return ye.delete(),a.formatData(ue,o.config)},Nt=function(o,a,d){let m=this.num_rows(),w=a.start_row||0,A=a.end_row||m,C=this._column_names().indexOf(o);if(C===-1)return;this.sides()>0&&C++;let P,W;a.data_slice?P=a.data_slice.get_column_slice(C):(W=this.get_data_slice(w,A,C,C+1),P=W.get_slice());let q=this._View.get_column_dtype(C),J=d(P,q,C);return P.delete(),W&&W.delete(),J};I.prototype.to_columns=function(o){return pt.call(this,o,_r.jsonTableFormatter)},I.prototype.to_json=function(o){return pt.call(this,o,_r.jsonFormatter)},I.prototype.to_csv=function(o){x(this.table.get_id()),o=Ke.bind(this)(o);let a=o.start_row,d=o.end_row,m=o.start_col,w=o.end_col,A=this.sides();if(this.is_unit_context)return s.to_csv_unit(this._View,a,d,m,w);if(A===0)return s.to_csv_zero(this._View,a,d,m,w);if(A===1)return s.to_csv_one(this._View,a,d,m,w);if(A===2)return s.to_csv_two(this._View,a,d,m,w)},I.prototype.col_to_js_typed_array=function(o,a={}){x(this.table.get_id());let d=s.col_to_js_typed_array;return Nt.call(this,o,a,d)},I.prototype.to_arrow=function(o={}){x(this.table.get_id()),o=Ke.bind(this)(o);let a=o.start_row,d=o.end_row,m=o.start_col,w=o.end_col,A=this.sides();if(this.is_unit_context)return s.to_arrow_unit(this._View,a,d,m,w);if(A===0)return s.to_arrow_zero(this._View,a,d,m,w);if(A===1)return s.to_arrow_one(this._View,a,d,m,w);if(A===2)return s.to_arrow_two(this._View,a,d,m,w)},I.prototype.num_rows=function(){return x(this.table.get_id()),this._View.num_rows()},I.prototype.num_columns=function(){let o=this._View.num_columns(),a=this._num_hidden();return o-o/(this.config.columns.length+a)*a},I.prototype.get_row_expanded=function(o){return this._View.get_row_expanded(o)},I.prototype.expand=function(o){return this._View.expand(o,this.config.group_by.length)},I.prototype.collapse=function(o){return this._View.collapse(o)},I.prototype.set_depth=function(o){return this._View.set_depth(o,this.config.group_by.length)},I.prototype._get_step_delta=async function(){let o=this._View.get_step_delta(0,2147483647),a;if(o.cells.size()===0)a=this.to_json();else{let d={};for(let w=0;w<o.cells.size();w++)d[o.cells.get(w).row]=!0;d=Object.keys(d);let m=d.map(w=>this.to_json({start_row:Number.parseInt(w),end_row:Number.parseInt(w)+1}));a=[].concat.apply([],m)}return o.cells.delete(),a},I.prototype._get_row_delta=async function(){if(this.is_unit_context)return s.get_row_delta_unit(this._View);{let o=this.sides(),a=y[o];return s[`get_row_delta_${a}`](this._View)}},I.prototype.on_update=function(o,{mode:a="none"}={}){if(x(this.table.get_id()),["none","row"].indexOf(a)===-1)throw new Error(`Invalid update mode "${a}" - valid modes are "none" and "row".`);a==="row"&&(this._View._get_deltas_enabled()||this._View._set_deltas_enabled(!0)),this.update_callbacks.push({view:this,orig_callback:o,callback:async(d,m)=>{m[d]===void 0&&(m[d]={});let w={port_id:d};a==="row"&&(m[d].row_delta===void 0&&(m[d].row_delta=await this._get_row_delta()),w.delta=m[d].row_delta),o(w)}})};function Ne(o,a){let d=0,m=0;for(;d<o.length;){let w=o[d];a(w,d,o)&&(o[m++]=w),d++}return o.length=m,o}I.prototype.remove_update=function(o){x(this.table.get_id());let a=this.update_callbacks.length;Ne(this.update_callbacks,d=>d.orig_callback!==o),console.assert(a>this.update_callbacks.length,'"callback" does not match a registered updater')},I.prototype.on_delete=function(o){this._delete_callbacks.push(o)},I.prototype.remove_delete=function(o){let a=this._delete_callbacks.length;Ne(this._delete_callbacks,d=>d!==o),console.assert(a>this._delete_callbacks.length,'"callback" does not match a registered delete callbacks')};function Oe(o){this.group_by=o.group_by||[],this.split_by=o.split_by||[],this.aggregates=o.aggregates||{},this.columns=o.columns,this.filter=o.filter||[],this.sort=o.sort||[],this.expressions=o.expressions||[],this.filter_op=o.filter_op||"and",this.group_by_depth=o.group_by_depth,this.split_by_depth=o.split_by_depth}Oe.prototype.get_group_by=function(){let o=s.make_string_vector();return Xe(o,this.group_by)},Oe.prototype.get_split_by=function(){let o=s.make_string_vector();return Xe(o,this.split_by)},Oe.prototype.get_columns=function(){let o=s.make_string_vector();return Xe(o,this.columns)},Oe.prototype.get_filter=function(){let o=s.make_2d_val_vector();for(let a of this.filter){let d=s.make_val_vector(),m=Xe(d,a);o.push_back(m)}return o},Oe.prototype.get_sort=function(){let o=s.make_2d_string_vector();for(let a of this.sort){let d=s.make_string_vector(),m=Xe(d,a);o.push_back(m)}return o},Oe.prototype.get_expressions=function(){let o=s.make_2d_val_vector();for(let a of this.expressions){let d=s.make_val_vector();for(let m of a)d.push_back(m);o.push_back(d)}return o};function H(o,a,d,m){this._Table=o,this.gnode_id=this._Table.get_gnode().get_id(),this._Table.get_pool().set_update_delegate(this),this.name=Math.random()+"",this.initialized=!1,this.index=a,this.limit=d,this.update_callbacks=[],this._delete_callbacks=[],this.views=[],this.overridden_types=m,lr(this)}H.prototype.get_id=function(){return this._Table.get_id()},H.prototype.get_pool=function(){return this._Table.get_pool()},H.prototype.make_port=function(){return this._Table.make_port()},H.prototype.remove_port=function(){this._Table.remove_port()},H.prototype._update_callback=function(o){let a={};for(let d in this.update_callbacks)this.update_callbacks[d].callback(o,a)},H.prototype.get_index=function(){return this.index},H.prototype.get_limit=function(){return this.limit},H.prototype.clear=function(){L(this.get_id()),this._Table.reset_gnode(this.gnode_id)},H.prototype.replace=function(o){L(this.get_id()),this._Table.reset_gnode(this.gnode_id),this.update(o),x(this.get_id())},H.prototype.delete=function(){if(this.views.length>0)throw`Cannot delete Table as it still has ${this.views.length} registered View(s).`;L(this.get_id()),this._Table.unregister_gnode(this.gnode_id),this._Table.delete();for(let o of this._delete_callbacks)o()},H.prototype.on_delete=function(o){this._delete_callbacks.push(o)},H.prototype.remove_delete=function(o){let a=this._delete_callbacks.length;Ne(this._delete_callbacks,d=>d!==o),console.assert(a>this._delete_callbacks.length,'"callback" does not match a registered delete callbacks')},H.prototype.size=function(){return x(this._Table.get_id()),this._Table.size()},H.prototype.schema=function(o=!0){let a=this._Table.get_schema(),d=a.columns(),m=a.types(),w={};for(let A=0;A<d.size();A++){let S=d.get(A);S!=="psp_okey"&&(o&&this.overridden_types[S]?w[S]=this.overridden_types[S]:w[S]=jt(m.get(A).value))}return a.delete(),d.delete(),m.delete(),w};function ve(o){let a=[],d={};for(let m of o){if(m.includes('""')){console.error(`Skipping expression '${m}', as it cannot reference an empty column!`);continue}let w={},A={},S=0,C,M=m.match(/^\/\/(?<alias>.+?)\n/);M?.groups?.alias&&(C=M.groups.alias.trim()),(!C||C.length==0)&&(C=m);let P=m.replace(/([a-zA-Z_]+[a-zA-Z0-9_]*)/g,J=>J=="true"?"True":J=="false"?"False":J);P=P.replace(/\"(.*?[^\\])\"/g,(J,pe)=>{if(pe=pe.replace(/\\"/g,'"'),w[pe]===void 0){let he=`COLUMN${S}`;w[pe]=he,A[he]=pe}return S++,w[pe]}),P=P.replace(/'(.*?[^\\])'/g,J=>`intern(${J})`);let W=(J,pe,he,ye)=>{let He=J.indexOf(he);return`${J.substring(0,He)}'${ye}'${J.substring(He+he.length)}`};P=P.replace(/(bucket|match|match_all|search|indexof)\(.*?,\s*(intern\(\'(.+)\'\)).*\)/g,W),P=P.replace(/(replace_all|replace)\(.*?,\s*(intern\(\'(.*)\'\)),.*\)/g,W);let q=[C,m,P,A];if(d[C]!==void 0){let J=d[C];a[J]=q}else a.push(q),d[C]=a.length-1}return a}H.prototype.validate_expressions=function(o,a=!0){let d={expression_schema:{},expression_alias:{},errors:{}};if(!o||o.length===0)return d;o=ve(o);let m=s.make_2d_val_vector();for(let P of o){let W=s.make_val_vector();for(let q of P)W.push_back(q);m.push_back(W),d.expression_alias[P[0]]=P[1]}let w=s.validate_expressions(this._Table,m),A=w.get_expression_schema(),S=w.get_expression_errors(),C=A.keys();for(let P=0;P<C.size();P++){let W=C.get(P),q=A.get(W);a&&this.overridden_types[W]&&(q=this.overridden_types[W]),d.expression_schema[W]=q}let M=S.keys();for(let P=0;P<M.size();P++){let W=M.get(P),q=S.get(W);d.errors[W]=q}return M.delete(),C.delete(),S.delete(),A.delete(),w.delete(),d},H.prototype.is_valid_filter=function(o){if(o[1]===ie.FILTER_OPERATORS.isNull||o[1]===ie.FILTER_OPERATORS.isNotNull)return!0;let a=o[2];if(a===null)return!1;let d=this.schema();return d[o[0]]&&(d[o[0]]==="date"||d[o[0]]==="datetime")?s.is_valid_datetime(o[2]):typeof a!="undefined"&&a!==null},H.prototype.view=function(o={}){x(this._Table.get_id());let a={};for(let C of Object.keys(o))if(dt[C])if(!a[dt[C]])$t.has(C)||(console.warn(`Deprecated: "${C}" config parameter, please use "${dt[C]}" instead`),$t.add(C)),a[dt[C]]=o[C];else throw new Error(`Duplicate configuration parameter "${C}"`);else if(C==="aggregate"){$t.has("aggregate")||(console.warn('Deprecated: "aggregate" config parameter has been replaced by "aggregates" and "columns"'),$t.add("aggregate")),a.aggregates={},a.columns=[];for(let M of o.aggregate)a.aggregates[M.column]=M.op,a.columns.push(M.column)}else if(Kr.indexOf(C)>-1)a[C]=o[C];else throw new Error(`Unrecognized config parameter "${C}"`);a.group_by=a.group_by||[],a.split_by=a.split_by||[],a.aggregates=a.aggregates||{},a.filter=a.filter||[],a.sort=a.sort||[],a.expressions=a.expressions||[];let d=this.schema();if(a.expressions.length>0&&(a.expressions=ve(a.expressions)),a.columns===void 0&&(a.columns=this.columns(),a.expressions.length>0))for(let C of a.expressions)a.columns.push(C[0]);if(a.filter.length>0)for(let C of a.filter){let M=d[C[0]];C[1]!==ie.FILTER_OPERATORS.isNull&&C[1]!==ie.FILTER_OPERATORS.isNotNull&&(M==="date"||M==="datetime")&&(C[2]=new Date(C[2]))}let m=Math.random()+"",w;a.group_by.length>0||a.split_by.length>0?a.split_by&&a.split_by.length>0?w=2:w=1:w=0;let A=new Oe(a),S=new I(this,w,a,A,m);return this.views.push(S),S};let Le;function It(){if(Le===void 0){let o=0,a=performance.now();setTimeout(function d(){let m=performance.now();console.log(`${(1e3*o/(m-a)).toFixed(2)} msgs/sec`),o=0,a=m,setTimeout(d,5e3)},5e3),Le=function(m){o+=m},console.log("Profiling initialized")}}H.prototype.update=function(o,a){a=a||{},a.port_id=a.port_id||0;let d,m=this.columns(),w=this._Table.get_schema(),A=w.types(),S=!1,C=!1;if(d=n,o instanceof ArrayBuffer?(d=new Uint8Array(o),S=!0):typeof o=="string"?(o[0]===","&&(o="_"+o),C=!0,S=!0,d=o):(n.init(o),n.names=m.concat(n.names.filter(M=>M==="__INDEX__")),n.types=cr(A).slice(0,m.length),Le&&Le(n.row_count)),!S){if(d.row_count===0){console.warn("table.update called with no data - ignoring");return}n.names.indexOf("__INDEX__")!=-1&&(!!this.index?n.types.push(n.types[n.names.indexOf(this.index)]):n.types.push(s.t_dtype.DTYPE_INT32))}try{let M=s.t_op.OP_INSERT;de(d,this._Table,this.index,this.limit,M,!0,S,C,a.port_id),this.initialized=!0}catch(M){console.error(`Update failed: ${M}`)}finally{w.delete()}},H.prototype.remove=function(o,a){if(!this.index){console.error("Cannot call `remove()` on a Table without a user-specified index.");return}a=a||{},a.port_id=a.port_id||0;let d,m=this.columns(),w=this._Table.get_schema(),A=w.types(),S=!1;o=o.map(C=>({[this.index]:C})),o instanceof ArrayBuffer?(d=new Uint8Array(o),S=!0):(n.init(o),n.names=[this.index],n.types=[cr(A)[m.indexOf(this.index)]],d=n);try{let C=s.t_op.OP_DELETE;de(d,this._Table,this.index,this.limit,C,!1,S,!1,a.port_id),this.initialized=!0}catch(C){console.error("Remove failed",C)}finally{w.delete()}},H.prototype.columns=function(){let o=this._Table.get_schema(),a=o.columns(),d=[];for(let m=0;m<a.size();m++){let w=a.get(m);w!=="psp_okey"&&d.push(w)}return o.delete(),a.delete(),d},H.prototype.execute=function(o){o(this)};let ie={__module__:s,Server:Ft,worker:function(){return this},initialize_profile_thread:It,memory_usage:B,table:function(o,a){a=a||{},a.index=a.index||null,a.limit=a.limit||null;let d,m=!1,w={},A=!1;if(o instanceof ArrayBuffer||typeof Buffer!="undefined"&&o instanceof Buffer?(d=new Uint8Array(o),m=!0):typeof o=="string"?(o[0]===","&&(o="_"+o),A=!0,m=!0,d=o):(n.clean(),w=n.init(o),d=n),a.index&&a.limit)throw`Cannot specify both index '${a.index}' and limit '${a.limit}'.`;let S;try{let C=s.t_op.OP_INSERT;return S=de(d,void 0,a.index,a.limit,C,!1,m,A,0),new H(S,a.index,a.limit,w)}catch(C){throw S&&S.delete(),console.error(`Table initialization failed: ${C}`),C}}};for(let o of Object.keys(xt))ie[o]=xt[o];class Mt extends Ft{constructor(a){super(a);self.addEventListener("message",d=>this.process(d.data),!1)}post(a,d){self.postMessage(a,d)}init(a){if(typeof WebAssembly=="undefined")throw new Error("WebAssembly not supported");s({wasmBinary:a.buffer,wasmJSMethod:"native-wasm"}).then(d=>{s=d,super.init(a)})}}return typeof self!="undefined"&&self.addEventListener&&new Mt(ie),ie}var pr;self.document!==void 0&&typeof WebAssembly!="undefined"?pr=self.perspective=dr(sr({wasmJSMethod:"native-wasm",printErr:h=>console.error(h),print:h=>console.log(h)})):pr=self.perspective=dr(sr);var Ko=pr;})();
//# sourceMappingURL=perspective.worker.js.map
